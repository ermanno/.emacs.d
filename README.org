* Emacs configuration
My personal Emacs configuration.

** Setup with nix and home-manager
The following kind of works on Fedora, I want to have a setup that works for Mac as well

*** Fedora
Install nix:

#+begin_src bash
sh <(curl -L https://nixos.org/nix/install)
. ~/.nix-profile/etc/profile.d/nix.sh
#+end_src

Create nix configuration:

#+begin_src bash
mkdir -p ~/.config/nix
#+end_src

Create in =~/.config/nix/nix.conf=:

#+begin_src bash
experimental-features = nix-command flakes
#+end_src

Install home-manager

#+begin_src bash
nix run home-manager -- init --switch
#+end_src

Create home-manager config in =~/.config/home-manager/=

This is =home.nix=

#+begin_src bash
{ config, pkgs, ... }:

{
  home.username = "ermann";
  home.homeDirectory = "/home/ermann";
  home.stateVersion = "23.11";

  programs.emacs = {
    enable = true;
    package = pkgs.emacs-gtk;
    extraPackages = (epkgs: [ epkgs.treesit-grammars.with-all-grammars ]);
  };

  programs.home-manager.enable = true;
}
#+end_src

This is flake.nix

#+begin_src bash
{
  description = "Home Manager configuration for ermann";

  inputs = {
    nixpkgs.url = "github:NixOS/nixpkgs/nixos-unstable";
    home-manager = {
      url = "github:nix-community/home-manager";
      inputs.nixpkgs.follows = "nixpkgs";
    };
  };

  outputs = { self, nixpkgs, home-manager, ... }:
    let
      username = "ermann";
      system = "x86_64-linux";  # Change to "aarch64-linux" for ARM or "x86_64-darwin" for macOS
    in
    {
      # Home Manager configuration
      homeConfigurations.${username} =
        home-manager.lib.homeManagerConfiguration {
          pkgs = import nixpkgs {
            inherit system;
            config.allowUnfree = true;
          };
          modules = [ ./home.nix ];
        };
    };
}
#+end_src

Add the following to =bashrc.sh= and source it again:

#+begin_src bash
# Nix and Home Manager setup
if [ -e /home/ermann/.nix-profile/etc/profile.d/nix.sh ]; then
  . /home/ermann/.nix-profile/etc/profile.d/nix.sh
fi

if [ -e ~/.nix-profile/etc/profile.d/nix.sh ]; then
  . ~/.nix-profile/etc/profile.d/nix.sh
fi

if [ -e /home/ermann/.nix-profile/etc/profile.d/hm-session-vars.sh ]; then
  . /home/ermann/.nix-profile/etc/profile.d/hm-session-vars.sh
fi
#+end_src

** Org mode LaTeX configuration

Install =latex= and =dvisvgm=

#+begin_src bash
sudo apt install texlive-latex-base dvisvgm
#+end_src

** Anki
Current setup requires to install pandoc: https://pandoc.org/installing.html

** Rust
Install rust-analyzer with:

#+begin_src bash
rustup component add rust-analyzer
#+end_src

Install rust-script (for Org Babel) with:

#+begin_src bash
cargo install rust-script
#+end_src

** TODO LSP configuration
Useful configuration to look at: https://www.ovistoica.com/blog/2024-7-05-modern-emacs-typescript-web-tsx-config

